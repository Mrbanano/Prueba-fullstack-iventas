var q=Object.defineProperty,B=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var P=(n,t,a)=>t in n?q(n,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[t]=a,u=(n,t)=>{for(var a in t||(t={}))b.call(t,a)&&P(n,a,t[a]);if(N)for(var a of N(t))y.call(t,a)&&P(n,a,t[a]);return n},p=(n,t)=>B(n,D(t));var C=(n,t)=>{var a={};for(var s in n)b.call(n,s)&&t.indexOf(s)<0&&(a[s]=n[s]);if(n!=null&&N)for(var s of N(n))t.indexOf(s)<0&&y.call(n,s)&&(a[s]=n[s]);return a};import{a as S,r,j as e,b as c,i as O,c as A,R as $,d as w,B as j,S as z,e as V,f as Z}from"./vendor.90dc3e5c.js";const K=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}};K();const I="/chat/api/v1/",G=async n=>{var t;try{const{data:a}=await S.post(`${I}Auth/signin`,n);return a}catch(a){return(t=a==null?void 0:a.response)==null?void 0:t.data}},J=async()=>{var n;try{const t=localStorage.getItem("token")||"",{data:a}=await S.get(`${I}Auth/verifytoken`,{headers:{"x-access-token":`${t}`}});return a}catch(t){return(n=t==null?void 0:t.response)==null?void 0:n.data}},Q=async n=>{var t;try{const a=localStorage.getItem("token")||"",{data:s}=await S.get(`${I}Message/${n}`,{headers:{"x-access-token":`${a}`}});return s}catch(a){return(t=a==null?void 0:a.response)==null?void 0:t.data}},g=r.exports.createContext(),W={id:null,isLoading:!0,isAuthenticated:!1,Name:null,lastName:null,Phone:null,Avatar:null,Age:null,Email:null,Priority:null,Problem:null,Promotion:null,CURP:null,Rol:null,online:null},X=({children:n})=>{const[t,a]=r.exports.useState(W),s=async(h,d)=>{const{data:l}=await G({Email:h,Password:d});if(l.message)return l.message;localStorage.setItem("token",l.token);const{user:m}=l;return a({isLoading:!1,isAuthenticated:!0,id:m.id,Name:m.Name,lastName:m.lastName,Phone:m.Phone,Avatar:m.Avatar,Age:m.Age,Email:m.Email,Priority:m.Priority,Problem:m.Problem,Promotion:m.Promotion,CURP:m.CURP,Rol:m.Rol,online:m.online}),"Se inicio correctamente sesi\xF3n"},o=()=>{localStorage.removeItem("token"),a({isLoading:!1,isAuthenticated:!1})},i=r.exports.useCallback(async()=>{const h=localStorage.getItem("token");if(h==null||h==null||!h)return a({isLoading:!1,isAuthenticated:!1}),!1;const d=await J();if(d.success==!1)return a({isLoading:!1,isAuthenticated:!1}),!1;localStorage.setItem("token",d.data.token);const{user:l}=d.data;return a({isLoading:!1,isAuthenticated:!0,id:l.id,Name:l.Name,lastName:l.lastName,Phone:l.Phone,Avatar:l.Avatar,Age:l.Age,Email:l.Email,Priority:l.Priority,Problem:l.Problem,Promotion:l.Promotion,CURP:l.CURP,Rol:l.Rol,online:l.online}),!0},[]);return e(g.Provider,{value:{auth:t,login:s,logout:o,verifyToken:i},children:n})};function Y(){return e("div",{className:"Hero",children:e("div",{className:"Hero-container",children:e("div",{className:"Hero-content",children:e("div",{className:"Hero-image"})})})})}function ee(){const{login:n}=r.exports.useContext(g),[t,a]=r.exports.useState({Email:"",Password:""}),s=({target:d})=>{const{name:l,value:m}=d;a(p(u({},t),{[l]:m}))},o=d=>{var l=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return l.test(String(d).toLowerCase())},i=()=>{const{Email:d,Password:l}=t;return o(d)&&l.length>8};return e("div",{className:"LoginForm",children:e("div",{className:"LoginForm-container",children:c("div",{className:"LoginForm-content",children:[e("div",{className:"Login-header",children:e("h1",{className:"Login-title",children:"Inicia sesi\xF3n"})}),e("div",{className:"Login-body",children:c("form",{onSubmit:async d=>{d.preventDefault();const{Email:l,Password:m}=t;if(!i())return alert("no se pudo inicar sesion"),alert("Datos incorrectos");await n(l,m)},children:[c("div",{className:"input-group",children:[e("label",{className:"Label",htmlFor:"email",children:"Correo electr\xF3nico"}),e("input",{id:"Email",type:"text",value:t.Email,name:"Email",required:!0,onChange:s})]}),c("div",{className:"input-group",children:[e("label",{className:"Label",htmlFor:"Password",children:"Contrase\xF1a"}),e("input",{id:"Password",type:"password",value:t.Password,name:"Password",required:!0,onChange:s})]}),e("button",{className:"btn btn_login",children:"Iniciar sesi\xF3n"})]})})]})})})}console.log("Hola, hola un gusto verte por ac\xE1, si est\xE1s explorando por aqu\xED es porque algo te encanto o algo realmente te asusto, sea lo que sea ponte en contacto y te platico de como y porque implemente ciertas cosas, me hubiera encantado pulirlo mas pero no me dio el tiempo");function te(){return e("div",{className:"Login",children:e("div",{className:"Login-container",children:c("div",{className:"Login-content",children:[e(Y,{}),e(ee,{})]})})})}const v={userLoaded:"[Chat]: Contacts in sidebar",userSelected:"[Chat]: Contact selected",newMessage:"[Chat]: New message",clearUserSelected:"[Chat]: Clear user selected",loadingHistory:"[Chat]: Loading history"},ne=(n,t)=>{switch(t.type){case v.userLoaded:return p(u({},n),{contacts:[...t.payload]});case v.userSelected:return n.userSelected===t.payload?n:p(u({},n),{receiver:t.payload,messages:[]});case v.clearUserSelected:return p(u({},n),{receiver:null});case v.newMessage:return n.receiver._id===t.payload.Receiver||n.receiver._id===t.payload.Sender?p(u({},n),{messages:[...n.messages,t.payload]}):n;case v.loadingHistory:return p(u({},n),{messages:[...t.payload]});default:return n}},f=r.exports.createContext(),ae={_id:"",receiver:null,contacts:[],messages:[]},se=({children:n})=>{const[t,a]=r.exports.useReducer(ne,ae);return e(f.Provider,{value:{chatState:t,dispatch:a},children:n})};var oe="/assets/Ilustration.3a4cc02b.svg";function re(){return e("div",{className:"ChatSelect",children:e("div",{className:"ChatSelect-container",children:c("div",{className:"ChatSelect-content",children:[e("div",{className:"ChatSelect-content-img",children:e("img",{src:oe,alt:"Escoge un chat para iniciar"})}),c("div",{className:"Chat-Selectec-content-text",children:[e("h1",{children:"Mensajer\xEDa en tiempo real"}),e("hr",{}),e("p",{children:"Selecciona un contacto de tu agenda y comienza a chatear al instante."})]})]})})})}var L="/assets/arrow_back.97feedb6.svg",ce="/assets/close.2cdf3fb4.svg";function k({showInfo:n,setshowInfo:t,InfoVisible:a}){const{chatState:s}=r.exports.useContext(f),[o,i]=r.exports.useState(!0),{Name:h,lastName:d,Phone:l,Avatar:m,Email:x,Age:R,CURP:F,Priotiry:M,Problem:H,Promotion:T}=s.receiver,_=()=>{i(!o)},U=()=>{t(!n)};return e("div",{className:`Info ${a} `,children:c("div",{className:"Info-container",children:[e("div",{className:"Info-back-header",children:e("div",{className:"header-modal",onClick:U,children:e("img",{src:L,alt:"icono para atras"})})}),e("div",{className:"Info-content",children:c("div",{className:"Info-header",children:[e("div",{className:"Info-header-image",children:e("img",{src:m,alt:`Avatar de ${h} ${d}`})}),c("div",{className:"Info-header-text",children:[e("p",{className:"Info-name-user",children:`${h} ${d}`}),e("p",{className:"Info-phone-user",children:l}),e("div",{children:e("a",{className:"Info-edit-user",href:"#",children:"Editar datos"})})]}),e("div",{className:"Info-body",children:c("details",{open:!0,children:[c("summary",{onClick:_,children:[e("strong",{children:"Datos del contacto"}),e("div",{children:e("img",{className:o?"":"flip",id:"show",src:ce,alt:"close"})})]}),c("div",{className:"Info-data",children:[c("div",{className:"Info-group",children:[e("label",{htmlFor:"email",children:"Correo"}),e("div",{className:"Info-field",children:e("p",{children:x})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"Name",children:"Nombre"}),e("div",{className:"Info-field",children:e("p",{children:h})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"lastName",children:"Apellido"}),e("div",{className:"Info-field",children:e("p",{children:d})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"Phone",children:"Telefono"}),e("div",{className:"Info-field",children:e("p",{children:l})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"Prioridad",children:"Prioridad"}),e("div",{className:"Info-field",children:e("p",{children:M})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"Problema",children:"Problema"}),e("div",{className:"Info-field",children:e("p",{children:H})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"Promocion",children:"Promocion"}),e("div",{className:"Info-field",children:e("p",{children:T})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"CURP",children:"CURP"}),e("div",{className:"Info-field",children:e("p",{children:F})})]}),c("div",{className:"Info-group",children:[e("label",{htmlFor:"Edad",children:"Edad"}),e("div",{className:"Info-field",children:e("p",{children:R})})]}),e("div",{className:"space"})]})]})})]})})]})})}function ie({message:n,type:t}){const{Message:a,createdAt:s}=n;return e("div",{className:"Message",children:e("div",{className:t==="sent"?"Message-container sent":" Message-container received",children:e("div",{className:"Message-content",children:e("p",{className:"message",children:a})})})})}function le(){const{chatState:n}=r.exports.useContext(f),{auth:t}=r.exports.useContext(g),{messages:a}=n;return e("div",{id:"conversation-content",className:"conversation-content",children:a.map(s=>e(ie,{message:s,type:s.Sender==t.id?"sent":"received"},s._id))})}var de="/assets/more_vert.5ee36e05.svg";function he({showInfo:n,setshowInfo:t}){const{chatState:a,dispatch:s}=r.exports.useContext(f),{Name:o,lastName:i,Avatar:h}=a.receiver,d=()=>{s({type:v.clearUserSelected,payload:[]})},l=()=>{t(!n)};return c("header",{className:"Chat-header",children:[e("div",{className:"header-modal  return",onClick:d,children:e("img",{src:L,alt:"icono para atras"})}),e("div",{className:"Chat-header-image",children:e("img",{src:h,alt:`Avatar de ${o} ${i}`})}),e("div",{className:"header-info",children:e("p",{className:"header-info-name",children:`${o} ${i}`})}),e("div",{className:"header-modal",onClick:l,children:e("img",{src:de,alt:"icono para mostrar"})})]})}const me=n=>{const[t,a]=r.exports.useState(null),[s,o]=r.exports.useState(!1),i=r.exports.useCallback(()=>{const d=localStorage.getItem("token"),l=O.connect(n,{transports:["websocket"],autoConnect:!0,forceNew:!0,query:{"x-access-token":d}});a(l)},[n]),h=r.exports.useCallback(()=>{t==null||t.disconnect()},[t]);return r.exports.useEffect(()=>{o(t==null?void 0:t.connected)},[t]),r.exports.useEffect(()=>{t==null||t.on("connect",()=>o(!0))},[t]),r.exports.useEffect(()=>{t==null||t.on("disconnect",()=>o(!1))},[t]),{socket:t,online:s,connectSocket:i,desconnectSocket:h}},ue=n=>{A.scrollToBottom({containerId:n,duration:0})},ve=n=>{A.scrollToBottom({containerId:n,duration:250})},E=r.exports.createContext(),pe="/",fe=({children:n})=>{const{socket:t,online:a,connectSocket:s,desconnectSocket:o}=me(pe),{auth:i}=r.exports.useContext(g),{dispatch:h}=r.exports.useContext(f);return r.exports.useEffect(()=>{i.isAuthenticated&&s()},[i,s]),r.exports.useEffect(()=>{i.isAuthenticated||o()},[i,o]),r.exports.useEffect(()=>{t==null||t.on("ShowContacts",d=>{h({type:v.userLoaded,payload:d})})},[t,h]),r.exports.useEffect(()=>{t==null||t.on("PrivateMessage",d=>{h({type:v.newMessage,payload:d}),ve("conversation-content")})},[t,h]),e(E.Provider,{value:{socket:t,online:a},children:n})};var ge="/assets/send.1a727e49.svg";function Ne(){const[n,t]=r.exports.useState(""),{socket:a}=r.exports.useContext(E),{auth:s}=r.exports.useContext(g),{chatState:o}=r.exports.useContext(f);return e("form",{onSubmit:d=>{d.preventDefault(),n.length!==0&&(a.emit("PrivateMessage",{Sender:s.id,Receiver:o.receiver._id,Message:n}),t(""))},children:c("section",{className:"TextToSend",children:[e("input",{type:"text",name:"sendtxt",className:"sendtxt",id:"sendtxt",value:n,onChange:({target:d})=>{t(d.value)}}),e("button",{className:"Send",children:e("img",{src:ge,alt:"send"})})]})})}function xe(){const[n,t]=r.exports.useState(!1);return n?e(k,{showInfo:n,setshowInfo:t,InfoVisible:"InfoVisible"}):e("div",{className:"Chat Chat-visible",children:e("div",{className:"Chat-container",children:c("div",{className:"Chat-content",children:[e(he,{showInfo:n,setshowInfo:t}),e(le,{}),e(Ne,{})]})})})}function Ce(){return e("div",{className:"ChatContent",children:e("div",{className:"ChatContent-container",children:c("div",{className:"ChatContent-content",children:[e(xe,{}),e(k,{})]})})})}function Se({contact:n}){var m;const{chatState:t,dispatch:a}=r.exports.useContext(f),{Avatar:s,Name:o,lastName:i,online:h}=n;let d=h?"online":"offline";const l=async()=>{a({type:v.userSelected,payload:n});const{data:x}=await Q(n._id);a({type:v.loadingHistory,payload:x}),ue("conversation-content")};return e("div",{className:`Contact  ${n._id==((m=t.receiver)==null?void 0:m._id)?"Select":""} `,onClick:l,children:e("div",{className:"Contact-container",children:c("div",{className:"Contact-content",children:[c("div",{className:"Contact-Avatar",children:[e("img",{src:s,alt:`Avatar de ${o} ${i}`}),e("span",{className:`status ${d}`})]}),c("div",{className:"Contact-info",children:[e("div",{className:"Contact-name",children:e("span",{children:`${o} ${i}`})}),e("div",{className:"Contact-status",children:e("span",{children:d})})]})]})})})}function Ie(){const{chatState:n}=r.exports.useContext(f),{auth:t}=r.exports.useContext(g),a=n.contacts;return e("div",{className:"Contacts",children:e("div",{className:"Contacts-container",children:c("div",{className:"Contacts-content",children:[a.filter(s=>s._id!=t.id).map(s=>e(Se,{contact:s},s._id)),e("div",{className:"extra-space"})]})})})}function be(){const{auth:n,logout:t}=r.exports.useContext(g);return c("div",{className:"Inbox-header",children:[e("div",{className:"Inbox-header-avatar",children:e("img",{className:"Inbox-header-img",src:n.Avatar,alt:`${n.Name}-${n.lastName}-`})}),c("div",{className:"Inbox-header-text",children:[e("p",{className:"Inbox-header-text-name",children:`${n.Name}  ${n.lastName}.`}),e("p",{className:"Inbox-header-text-number",children:n.Phone}),e("button",{className:"Inbox-logout",onClick:t,children:"Cerrar Sesi\xF3n"})]})]})}var ye="/assets/icon.505dbc8f.svg";function Pe(){return e("div",{className:"Icon",children:e("div",{className:"Icon-container",children:e("div",{className:"Icon-content",children:e("img",{src:ye,alt:"Revisa tus"})})})})}function Ae(){return e("div",{className:"Title-container",children:c("div",{className:"Inbox-title",children:[e(Pe,{}),e("h1",{className:"Inbox-header-title",children:"Chats"})]})})}function $e(){return e("div",{className:"Inbox",children:e("div",{className:"Inbox-container",children:c("div",{className:"Inbox-content",children:[e(be,{}),c("div",{className:"Inbox-scroll",children:[e(Ae,{}),e(Ie,{})]})]})})})}function we(){const{chatState:n}=r.exports.useContext(f);return e("div",{className:"ChatPage",children:e("div",{className:"ChatPage-container",children:c("div",{className:"ChatPage-content",children:[e($e,{}),n.receiver?e(Ce,{}):e(re,{})]})})})}function Le(){return e("div",{className:"Loading",children:e("div",{className:"Loading-container",children:c("div",{className:"Loading-content",children:[e("div",{className:"loader loader1",children:e("div",{children:e("div",{children:e("div",{children:e("div",{children:e("div",{children:e("div",{})})})})})})}),e("div",{className:"Loading-text",children:e("h1",{children:"Cargando..."})})]})})})}const ke=s=>{var o=s,{isAuthenticated:n,component:t}=o,a=C(o,["isAuthenticated","component"]);return e($,p(u({},a),{component:i=>n?e(w,{to:"/"}):e(t,u({},i))}))},Ee=s=>{var o=s,{isAuthenticated:n,component:t}=o,a=C(o,["isAuthenticated","component"]);return e($,p(u({},a),{component:i=>n?e(t,u({},i)):e(w,{to:"/login"})}))};function Re(){const{auth:n,verifyToken:t}=r.exports.useContext(g);return r.exports.useEffect(()=>{t()},[t]),n.isLoading?e(Le,{}):e(j,{children:e("div",{children:c(z,{children:[e(ke,{isAuthenticated:n.isAuthenticated,path:"/login",component:te}),e(Ee,{isAuthenticated:n.isAuthenticated,path:"/",component:we})]})})})}function Fe(){return r.exports.useState(""),r.exports.useState(""),r.exports.useState(null),e(se,{children:e(X,{children:e(fe,{children:e("div",{className:"App",children:e("div",{className:"App-container",children:e("div",{className:"App-content",children:e(Re,{})})})})})})})}V.render(e(Z.StrictMode,{children:e(Fe,{})}),document.getElementById("root"));
